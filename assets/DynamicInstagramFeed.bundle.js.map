{"version":3,"sources":["webpack:///./source/scripts/Layout.js","webpack:///./source/scripts/sections/DynamicInstagramFeed.js","webpack:///./node_modules/just-debounce/index.js"],"names":["eventHandlers","previousBreakpoint","getBreakpoints","window","getComputedStyle","document","documentElement","getPropertyValue","replace","split","getBreakpoint","$","on","event","currentBreakpoint","forEach","eventHandler","previous","current","isLessThanBreakpoint","breakpoint","inclusive","breakpoints","comparison","indexOf","isGreaterThanBreakpoint","isBreakpoint","some","onBreakpointChange","push","offBreakpointChange","index","splice","DynamicInstagramFeed","section","settings","data","onboarding","photoCount","photo_count","accessToken","access_token","$el","el","_load","$window","$photoContainer","find","$photoContainerPlaceholder","$photoTemplate","_mobileSlider","bind","layout","_getPhotos","done","photos","_renderPhotos","fail","error","console","warn","url","photoPromise","ajax","dataType","then","response","meta","code","error_message","error_type","Deferred","reject","promise","photoArray","photoIndex","photo","$template","clone","lowResolution","images","low_resolution","standardResolution","standard_resolution","imageURL","devicePixelRatio","$link","user","username","link","$photo","append","fadeOut","_destroyFlickity","remove","flickity","Flickity","cellSelector","contain","freeScroll","percentPosition","prevNextButtons","pageDots","setGallerySize","_bindSlider","off","destroy","_initFlickity","$slider","debounce","trigger","height","Math","ceil","maxCellHeight"],"mappings":";;;;;;AAAA;AAAA;AAAA;AAEA,IAAMA,aAAa,GAAG,EAAtB;AACA,IAAIC,kBAAkB,GAAG,IAAzB;;AAEA,SAASC,cAAT,GAA0B;AACxB,SAAOC,MAAM,CACVC,gBADI,CACaC,QAAQ,CAACC,eADtB,EACuC,SADvC,EAEJC,gBAFI,CAEa,SAFb,EAGJC,OAHI,CAGI,IAHJ,EAGU,EAHV,EAIJC,KAJI,CAIE,GAJF,CAAP;AAKD;;AAED,SAASC,aAAT,GAAyB;AACvB,SAAOP,MAAM,CACVC,gBADI,CACaC,QAAQ,CAACC,eADtB,EACuC,QADvC,EAEJC,gBAFI,CAEa,SAFb,EAGJC,OAHI,CAGI,IAHJ,EAGU,EAHV,CAAP;AAID;;AAEDG,6CAAC,CAACR,MAAD,CAAD,CAAUS,EAAV,CAAa,QAAb,EAAuB,UAAAC,KAAK,EAAI;AAC9B,MAAMC,iBAAiB,GAAGJ,aAAa,EAAvC;;AAEA,MAAIT,kBAAkB,KAAKa,iBAA3B,EAA8C;AAC5Cd,iBAAa,CAACe,OAAd,CAAsB,UAAAC,YAAY,EAAI;AACpCA,kBAAY,CAACH,KAAD,EAAQ;AAClBI,gBAAQ,EAAEhB,kBADQ;AAElBiB,eAAO,EAAEJ;AAFS,OAAR,CAAZ;AAID,KALD;AAMD;;AAEDb,oBAAkB,GAAGa,iBAArB;AACD,CAbD;;AAeA,SAASK,oBAAT,CAA8BC,UAA9B,EAA6D;AAAA,MAAnBC,SAAmB,uEAAP,KAAO;AAC3D,MAAMC,WAAW,GAAGpB,cAAc,EAAlC;AACA,MAAMY,iBAAiB,GAAGJ,aAAa,EAAvC;AACA,MAAMa,UAAU,GAAGD,WAAW,CAACE,OAAZ,CAAoBV,iBAApB,IAAyCQ,WAAW,CAACE,OAAZ,CAAoBJ,UAApB,CAA5D;AAEA,SAAOC,SAAS,GAAGE,UAAU,IAAI,CAAjB,GAAqBA,UAAU,GAAG,CAAlD;AACD;;AAED,SAASE,uBAAT,CAAiCL,UAAjC,EAAgE;AAAA,MAAnBC,SAAmB,uEAAP,KAAO;AAC9D,MAAMC,WAAW,GAAGpB,cAAc,EAAlC;AACA,MAAMY,iBAAiB,GAAGJ,aAAa,EAAvC;AACA,MAAMa,UAAU,GAAGD,WAAW,CAACE,OAAZ,CAAoBV,iBAApB,IAAyCQ,WAAW,CAACE,OAAZ,CAAoBJ,UAApB,CAA5D;AAEA,SAAOC,SAAS,GAAGE,UAAU,IAAI,CAAjB,GAAqBA,UAAU,GAAG,CAAlD;AACD;;AAED,SAASG,YAAT,GAAsC;AACpC,MAAMZ,iBAAiB,GAAGJ,aAAa,EAAvC;;AADoC,oCAAbY,WAAa;AAAbA,eAAa;AAAA;;AAEpC,SAAOA,WAAW,CAACK,IAAZ,CAAiB,UAAAP,UAAU;AAAA,WAAIA,UAAU,KAAKN,iBAAnB;AAAA,GAA3B,CAAP;AACD;;AAED,SAASc,kBAAT,CAA4BZ,YAA5B,EAA0C;AACxC,MAAIhB,aAAa,CAACwB,OAAd,CAAsBR,YAAtB,MAAwC,CAAC,CAA7C,EAAgD;AAC9ChB,iBAAa,CAAC6B,IAAd,CAAmBb,YAAnB;AACD;AACF;;AAED,SAASc,mBAAT,CAA6Bd,YAA7B,EAA2C;AACzC,MAAMe,KAAK,GAAG/B,aAAa,CAACwB,OAAd,CAAsBR,YAAtB,CAAd;;AAEA,MAAIe,KAAK,KAAK,CAAC,CAAf,EAAkB;AAChB/B,iBAAa,CAACgC,MAAd,CAAqBD,KAArB,EAA4B,CAA5B;AACD;AACF;;AAEc;AACbZ,sBAAoB,EAApBA,oBADa;AAEbM,yBAAuB,EAAvBA,uBAFa;AAGbC,cAAY,EAAZA,YAHa;AAIbE,oBAAkB,EAAlBA,kBAJa;AAKbE,qBAAmB,EAAnBA;AALa,CAAf,E;;;;;;;;;;;;;;;;;;;;;;;ACtEA;AACA;AACA;AAEA;;IAEqBG,oB;;;AACnB,gCAAYC,OAAZ,EAAqB;AAAA;;AACnB,SAAKC,QAAL,GAAgBD,OAAO,CAACE,IAAxB;AACA,SAAKC,UAAL,GAAkB,KAAKF,QAAL,CAAcE,UAAhC;AACA,SAAKC,UAAL,GAAkB,KAAKH,QAAL,CAAcI,WAAhC;AACA,SAAKC,WAAL,GAAmB,KAAKL,QAAL,CAAcM,YAAjC;AACA,SAAKC,GAAL,GAAW/B,6CAAC,CAACuB,OAAO,CAACS,EAAT,CAAZ;;AAEA,SAAKC,KAAL;AACD;;;;4BAEO;AAAA;;AACN,WAAKC,OAAL,GAAelC,6CAAC,CAACR,MAAD,CAAhB;AACA,WAAK2C,eAAL,GAAuB,KAAKJ,GAAL,CAASK,IAAT,CAAc,0BAAd,CAAvB;AACA,WAAKC,0BAAL,GAAkC,KAAKN,GAAL,CAASK,IAAT,CAAc,oCAAd,CAAlC;AAEA,WAAKE,cAAL,GAAsBtC,6CAAC,CAAC,0DAAD,CAAvB,CALM,CAON;;AACA,WAAKuC,aAAL,GAAqB,KAAKA,aAAL,CAAmBC,IAAnB,CAAwB,IAAxB,CAArB;AACAC,6DAAM,CAACxB,kBAAP,CAA0B,KAAKsB,aAA/B;;AACA,WAAKA,aAAL;;AAEA,UAAI,KAAKb,UAAL,IAAmB,CAAC,KAAKG,WAA7B,EAA0C;AACxC;AACD;;AAED,WAAKa,UAAL,GACGC,IADH,CACQ,UAAAC,MAAM;AAAA,eAAI,KAAI,CAACC,aAAL,CAAmBD,MAAnB,CAAJ;AAAA,OADd,EAEGE,IAFH,CAEQ,UAAAC,KAAK,EAAI;AACbC,eAAO,CAACC,IAAR,sBAA2BF,KAA3B;AACD,OAJH;AAKD;;;iCAEY;AACX,UAAMG,GAAG,+EAAwE,KAAKrB,WAA7E,oBAAkG,KAAKF,UAAvG,eAAT;AACA,UAAMwB,YAAY,GAAGnD,6CAAC,CAACoD,IAAF,CAAOF,GAAP,EAAY;AAC/BG,gBAAQ,EAAE;AADqB,OAAZ,CAArB;AAIA,aAAOF,YAAY,CAACG,IAAb,CAAkB,UAAAC,QAAQ,EAAI;AACnC,YAAIA,QAAQ,CAACC,IAAT,CAAcC,IAAd,KAAuB,GAA3B,EAAgC;AAC9B,cAAMV,KAAK,aAAMQ,QAAQ,CAACC,IAAT,CAAcE,aAApB,eAAsCH,QAAQ,CAACC,IAAT,CAAcG,UAApD,MAAX;AACA,iBAAO3D,6CAAC,CAAC4D,QAAF,GAAaC,MAAb,CAAoBd,KAApB,EAA2Be,OAA3B,EAAP;AACD;;AAED,eAAOP,QAAQ,CAAC9B,IAAhB;AACD,OAPM,CAAP;AAQD;;;kCAEamB,M,EAAQ;AAAA;;AACpB,UAAMmB,UAAU,GAAG,EAAnB;AACA,UAAIC,UAAU,GAAG,CAAjB;AACApB,YAAM,CAACxC,OAAP,CAAe,UAAA6D,KAAK,EAAI;AACtBD,kBAAU,IAAI,CAAd;;AACA,YAAME,SAAS,GAAG,MAAI,CAAC5B,cAAL,CAAoB6B,KAApB,EAAlB;;AACA,YAAMC,aAAa,GAAGH,KAAK,CAACI,MAAN,CAAaC,cAAnC;AACA,YAAMC,kBAAkB,GAAGN,KAAK,CAACI,MAAN,CAAaG,mBAAxC;AACA,YAAIC,QAAQ,GAAGL,aAAa,CAAClB,GAA7B;;AAEA,YAAI1D,MAAM,CAACkF,gBAAP,IAA2B,CAA/B,EAAkC;AAChCD,kBAAQ,GAAGF,kBAAkB,CAACrB,GAA9B;AACD;;AAED,YAAMyB,KAAK,GAAG3E,6CAAC,sCAA8BgE,UAA9B,iBAA+CC,KAAK,CAACW,IAAN,CAAWC,QAA1D,sDAA0GZ,KAAK,CAACa,IAAhH,aAAf;AACA,YAAMC,MAAM,GAAG/E,6CAAC,qIAImByE,QAJnB,gDAKQT,UALR,iBAKyBC,KAAK,CAACW,IAAN,CAAWC,QALpC,wCAAhB;AASAF,aAAK,CAACK,MAAN,CAAaD,MAAb;AACAb,iBAAS,CAACc,MAAV,CAAiBL,KAAjB;AAEAZ,kBAAU,CAAC7C,IAAX,CAAgBgD,SAAhB;AACD,OAzBD;AA2BA,WAAK7B,0BAAL,CAAgC4C,OAAhC,CAAwC,YAAM;AAC5C,cAAI,CAACC,gBAAL;;AACA,cAAI,CAAC/C,eAAL,CAAqB6C,MAArB,CAA4BjB,UAA5B;;AACA,cAAI,CAAC1B,0BAAL,CAAgC8C,MAAhC;;AACA,cAAI,CAAC5C,aAAL;AACD,OALD;AAMD;;;oCAGe;AACd,WAAK6C,QAAL,GAAgB,IAAIC,+CAAJ,CAAa,KAAKlD,eAAL,CAAqB,CAArB,CAAb,EAAsC;AACpDmD,oBAAY,EAAE,mBADsC;AAEpDC,eAAO,EAAE,IAF2C;AAGpDC,kBAAU,EAAE,IAHwC;AAIpDC,uBAAe,EAAE,KAJmC;AAKpDC,uBAAe,EAAE,KALmC;AAMpDC,gBAAQ,EAAE,KAN0C;AAOpDC,sBAAc,EAAE;AAPoC,OAAtC,CAAhB;;AAUA,WAAKC,WAAL;AACD;;;uCAEkB;AACjB,UAAI,CAAC,KAAKT,QAAV,EAAoB;AAClB;AACD;;AAED,WAAKlD,OAAL,CAAa4D,GAAb,CAAiB,iBAAjB;AACA,WAAK3D,eAAL,CAAqB2D,GAArB,CAAyB,iBAAzB;AACA,WAAKV,QAAL,CAAcW,OAAd;AACA,WAAKX,QAAL,GAAgB,IAAhB;AACD;;;oCAEe;AACd;AACA,UAAI3C,uDAAM,CAAC3B,uBAAP,CAA+B,GAA/B,CAAJ,EAAyC;AACvC,aAAKoE,gBAAL;;AACA;AACD,OALa,CAOd;;;AACA,UAAI,KAAKE,QAAT,EAAmB;AACjB;AACD,OAVa,CAYd;;;AACA,WAAKY,aAAL;AACD;;;kCAEa;AAAA;;AACZ,UAAMC,OAAO,GAAG,KAAK9D,eAAL,CAAqBC,IAArB,CAA0B,kBAA1B,CAAhB;AAEA,WAAKF,OAAL,CAAajC,EAAb,CAAgB,uBAAhB,EAAyCiG,oDAAQ,CAAC,YAAM;AACtD,cAAI,CAAC/D,eAAL,CAAqBgE,OAArB,CAA6B,6BAA7B;AACD,OAFgD,CAAjD;AAIA,WAAKf,QAAL,CAAcnF,EAAd,CAAiB,YAAjB,EAA+B,YAAM;AACnC,cAAI,CAACkC,eAAL,CAAqBgE,OAArB,CAA6B,6BAA7B;AACD,OAFD;AAIA,WAAKhE,eAAL,CAAqBlC,EAArB,CAAwB,6BAAxB,EAAuD,YAAM;AAC3D,YAAI,CAAC,MAAI,CAACmF,QAAV,EAAoB;AAClB;AACD;;AAEDa,eAAO,CAACG,MAAR,CAAeC,IAAI,CAACC,IAAL,CAAU,MAAI,CAAClB,QAAL,CAAcmB,aAAxB,CAAf;AACD,OAND,EAXY,CAmBZ;;AACA,WAAKpE,eAAL,CAAqBgE,OAArB,CAA6B,6BAA7B;AACD;;;;;;;;;;;;;AC7JH;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"DynamicInstagramFeed.bundle.js","sourcesContent":["import $ from 'jquery';\n\nconst eventHandlers = [];\nlet previousBreakpoint = null;\n\nfunction getBreakpoints() {\n  return window\n    .getComputedStyle(document.documentElement, ':before')\n    .getPropertyValue('content')\n    .replace(/\"/g, '')\n    .split(',');\n}\n\nfunction getBreakpoint() {\n  return window\n    .getComputedStyle(document.documentElement, ':after')\n    .getPropertyValue('content')\n    .replace(/\"/g, '');\n}\n\n$(window).on('resize', event => {\n  const currentBreakpoint = getBreakpoint();\n\n  if (previousBreakpoint !== currentBreakpoint) {\n    eventHandlers.forEach(eventHandler => {\n      eventHandler(event, {\n        previous: previousBreakpoint,\n        current: currentBreakpoint,\n      });\n    });\n  }\n\n  previousBreakpoint = currentBreakpoint;\n});\n\nfunction isLessThanBreakpoint(breakpoint, inclusive = false) {\n  const breakpoints = getBreakpoints();\n  const currentBreakpoint = getBreakpoint();\n  const comparison = breakpoints.indexOf(currentBreakpoint) - breakpoints.indexOf(breakpoint);\n\n  return inclusive ? comparison <= 0 : comparison < 0;\n}\n\nfunction isGreaterThanBreakpoint(breakpoint, inclusive = false) {\n  const breakpoints = getBreakpoints();\n  const currentBreakpoint = getBreakpoint();\n  const comparison = breakpoints.indexOf(currentBreakpoint) - breakpoints.indexOf(breakpoint);\n\n  return inclusive ? comparison >= 0 : comparison > 0;\n}\n\nfunction isBreakpoint(...breakpoints) {\n  const currentBreakpoint = getBreakpoint();\n  return breakpoints.some(breakpoint => breakpoint === currentBreakpoint);\n}\n\nfunction onBreakpointChange(eventHandler) {\n  if (eventHandlers.indexOf(eventHandler) === -1) {\n    eventHandlers.push(eventHandler);\n  }\n}\n\nfunction offBreakpointChange(eventHandler) {\n  const index = eventHandlers.indexOf(eventHandler);\n\n  if (index !== -1) {\n    eventHandlers.splice(index, 1);\n  }\n}\n\nexport default {\n  isLessThanBreakpoint,\n  isGreaterThanBreakpoint,\n  isBreakpoint,\n  onBreakpointChange,\n  offBreakpointChange,\n};\n","import $ from 'jquery';\nimport debounce from 'just-debounce';\nimport Flickity from 'flickity';\n\nimport layout from '../Layout';\n\nexport default class DynamicInstagramFeed {\n  constructor(section) {\n    this.settings = section.data;\n    this.onboarding = this.settings.onboarding;\n    this.photoCount = this.settings.photo_count;\n    this.accessToken = this.settings.access_token;\n    this.$el = $(section.el);\n\n    this._load();\n  }\n\n  _load() {\n    this.$window = $(window);\n    this.$photoContainer = this.$el.find('[data-instagram-content]');\n    this.$photoContainerPlaceholder = this.$el.find('[data-instagram-photo-placeholder]');\n\n    this.$photoTemplate = $('<figure class=\"instagram--photo\" data-instagram-photo />');\n\n    // Activate flickity on mobile\n    this._mobileSlider = this._mobileSlider.bind(this);\n    layout.onBreakpointChange(this._mobileSlider);\n    this._mobileSlider();\n\n    if (this.onboarding || !this.accessToken) {\n      return;\n    }\n\n    this._getPhotos()\n      .done(photos => this._renderPhotos(photos))\n      .fail(error => {\n        console.warn(`Instagram: ${error}`);\n      });\n  }\n\n  _getPhotos() {\n    const url = `https://api.instagram.com/v1/users/self/media/recent?access_token=${this.accessToken}&count=${this.photoCount}&callback=`;\n    const photoPromise = $.ajax(url, {\n      dataType: 'jsonp',\n    });\n\n    return photoPromise.then(response => {\n      if (response.meta.code !== 200) {\n        const error = `${response.meta.error_message} (${response.meta.error_type})`;\n        return $.Deferred().reject(error).promise();\n      }\n\n      return response.data;\n    });\n  }\n\n  _renderPhotos(photos) {\n    const photoArray = [];\n    let photoIndex = 0;\n    photos.forEach(photo => {\n      photoIndex += 1;\n      const $template = this.$photoTemplate.clone();\n      const lowResolution = photo.images.low_resolution;\n      const standardResolution = photo.images.standard_resolution;\n      let imageURL = lowResolution.url;\n\n      if (window.devicePixelRatio >= 2) {\n        imageURL = standardResolution.url;\n      }\n\n      const $link = $(`<a aria-label=\"view photo ${photoIndex} by ${photo.user.username} on instagram\" target=\"_blank\" href=\"${photo.link}\"></a>`);\n      const $photo = $(`\n        <div\n          class=\"instagram--photo-img\"\n          role=\"img\"\n          style=\"background-image: url(${imageURL});\"\n          aria-label=\"photo ${photoIndex} by ${photo.user.username} on instagram\"\n        >\n      `);\n\n      $link.append($photo);\n      $template.append($link);\n\n      photoArray.push($template);\n    });\n\n    this.$photoContainerPlaceholder.fadeOut(() => {\n      this._destroyFlickity();\n      this.$photoContainer.append(photoArray);\n      this.$photoContainerPlaceholder.remove();\n      this._mobileSlider();\n    });\n  }\n\n\n  _initFlickity() {\n    this.flickity = new Flickity(this.$photoContainer[0], {\n      cellSelector: '.instagram--photo',\n      contain: true,\n      freeScroll: true,\n      percentPosition: false,\n      prevNextButtons: false,\n      pageDots: false,\n      setGallerySize: false,\n    });\n\n    this._bindSlider();\n  }\n\n  _destroyFlickity() {\n    if (!this.flickity) {\n      return;\n    }\n\n    this.$window.off('.instagram-feed');\n    this.$photoContainer.off('.instagram-feed');\n    this.flickity.destroy();\n    this.flickity = null;\n  }\n\n  _mobileSlider() {\n    // If is large or medium layout, attempt to destroy flickity\n    if (layout.isGreaterThanBreakpoint('S')) {\n      this._destroyFlickity();\n      return;\n    }\n\n    // Is XS/S/M, and flickity is init'd -- do nothing\n    if (this.flickity) {\n      return;\n    }\n\n    // Is XS/S/M, and flickity is not init'd\n    this._initFlickity();\n  }\n\n  _bindSlider() {\n    const $slider = this.$photoContainer.find('.flickity-slider');\n\n    this.$window.on('resize.instagram-feed', debounce(() => {\n      this.$photoContainer.trigger('heightUpdate.instagram-feed');\n    }));\n\n    this.flickity.on('cellSelect', () => {\n      this.$photoContainer.trigger('heightUpdate.instagram-feed');\n    });\n\n    this.$photoContainer.on('heightUpdate.instagram-feed', () => {\n      if (!this.flickity) {\n        return;\n      }\n\n      $slider.height(Math.ceil(this.flickity.maxCellHeight));\n    });\n\n    // Sets the Slider to the height of the first slide\n    this.$photoContainer.trigger('heightUpdate.instagram-feed');\n  }\n}\n","module.exports = debounce\n\nfunction debounce (fn, delay, at_start, guarantee) {\n  var timeout\n  var args\n  var self\n\n  return function debounced () {\n    self = this\n    args = Array.prototype.slice.call(arguments)\n\n    if (timeout && (at_start || guarantee)) {\n      return\n    } else if (!at_start) {\n      clear()\n\n      timeout = setTimeout(run, delay)\n      return timeout\n    }\n\n    timeout = setTimeout(clear, delay)\n    fn.apply(self, args)\n\n    function run () {\n      clear()\n      fn.apply(self, args)\n    }\n\n    function clear () {\n      clearTimeout(timeout)\n      timeout = null\n    }\n  }\n}\n"],"sourceRoot":""}