{"version":3,"sources":["webpack:///./source/scripts/sections/StaticProduct.js"],"names":["StaticProduct","section","postMessage","context","data","settings","product","richText","reviewForm","$el","$","el","$product","find","isThreeColumn","layout","isThemeEditor","window","Shopify","designMode","useHistory","history","replaceState","gallery","$details","$description","$formRegular","$formAlt","$formArea","layoutHandler","onBreakpointChange","bind","$productReviews","_moveForm","length","RichText","Forms","$script","options","sectionId","id","productDetails","ProductDetails","_updatePrices","each","index","CurrencyConverter","update","offBreakpointChange","unload","isGreaterThanBreakpoint","contains","$form","detach","append"],"mappings":"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","file":"StaticProduct.bundle.js","sourcesContent":["import $ from 'jquery';\nimport $script from 'scriptjs';\nimport CurrencyConverter from 'shopify-currency-converter';\nimport layout from '../Layout';\nimport Forms from '../Forms';\n\nimport RichText from '../components/RichText';\nimport ProductDetails from '../components/ProductDetails';\n\nexport default class StaticProduct {\n  constructor(section) {\n    this.section = section;\n    this.postMessage = section.postMessage;\n    this.context = section.data.context;\n    this.settings = section.data.settings;\n    this.product = section.data.product;\n    this.richText = null;\n    this.reviewForm = null;\n\n    this.$el = $(section.el);\n    this.$product = this.$el.find('[data-product-wrapper]');\n\n    if (this.settings) {\n      this.isThreeColumn = this.settings.layout === 'layout--three-col';\n    }\n\n    // History\n    this.isThemeEditor = window.Shopify && window.Shopify.designMode;\n    this.useHistory = !this.isThemeEditor && history.replaceState;\n\n    const gallery = this.$product.find('[data-product-gallery]')[0];\n\n    // Product details\n    this.$details = this.$product.find('[data-product-details]');\n\n    // Product description\n    this.$description = this.$product.find('[data-product-description]');\n\n    // Product form containers\n    this.$formRegular = this.$product.find('[data-product-form-regular]');\n    this.$formAlt = this.$product.find('[data-product-form-alt]');\n\n    // Product form area\n    this.$formArea = this.$product.find('[data-product-form-area]');\n\n    // Move product form and information on breakpoint change\n    this.layoutHandler = this.onBreakpointChange.bind(this);\n    layout.onBreakpointChange(this.layoutHandler);\n\n    // Product reviews\n    this.$productReviews = this.$el.find('[data-product-reviews]');\n\n    this._moveForm();\n\n    if (this.$description.length) {\n      this.richText = new RichText(this.$description);\n    }\n\n    if (this.$productReviews.length) {\n      this.reviewForm = new Forms(this.$productReviews, '.spr-form-input');\n    }\n\n    // Instantiate ProductDetails after Shopify API is loaded\n    $script($('[data-scripts]').data('shopify-api-url'), () => {\n      const options = {\n        $formArea: this.$formArea,\n        $details: this.$details,\n        gallery,\n        context: this.context,\n        settings: this.settings,\n        product: this.product,\n        useHistory: this.useHistory,\n        sectionId: section.id,\n      };\n\n      this.productDetails = new ProductDetails(options);\n    });\n\n    this._updatePrices();\n  }\n\n  _updatePrices() {\n    this.$el.find('.money:not([data-currency]').each((index, el) => CurrencyConverter.update(el));\n  }\n\n  onSectionUnload() {\n    layout.offBreakpointChange(this.layoutHandler);\n\n    if (this.productDetails) {\n      this.productDetails.unload();\n    }\n\n    if (this.richText) {\n      this.richText.unload();\n    }\n\n    if (this.reviewForm) {\n      this.reviewForm.unload();\n    }\n  }\n\n  onBreakpointChange() {\n    this._moveForm();\n  }\n\n  /**\n   * Move product form if is a three column layout\n   * @private\n   */\n  _moveForm() {\n    if (!this.isThreeColumn) return;\n\n    if (layout.isGreaterThanBreakpoint('M')) {\n      if (!$.contains(this.$formAlt[0], this.$formArea[0])) {\n        const $form = this.$formArea.detach();\n        this.$formAlt.append($form);\n      }\n    } else if (!$.contains(this.$formRegular[0], this.$formArea[0])) {\n      const $form = this.$formArea.detach();\n      this.$formRegular.append($form);\n    }\n  }\n}\n"],"sourceRoot":""}